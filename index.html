<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gift Name Shuffler</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <h1>Gift Name Shuffler</h1>
        <p>Organize Secret Santa and gift exchanges easily!</p>
    </header>

    <main>
        <!-- Section 1: Manage Persons -->
        <section id="persons-section" class="card">
            <h2>Persons</h2>
            <div class="form-row">
                <input type="text" id="person-name" placeholder="Person name">
                <select id="person-group">
                    <option value="">-- No group --</option>
                </select>
                <button onclick="addPerson()">Add Person</button>
            </div>
            <ul id="persons-list"></ul>
        </section>

        <!-- Section: SOLID Account -->
        <section id="solid-section" class="card">
            <h2>Mijn Solid Pod</h2>
            <p class="info-text">Koppel je <a href="https://solidproject.org/users/get-a-pod" target="_blank" rel="noopener">Solid Pod</a> om je wishlist te beheren. Je data blijft van jou! <a href="solid-aanmelden.md" target="_blank">Hoe maak ik een account?</a></p>

            <!-- Not logged in -->
            <div id="solid-login">
                <div class="form-row">
                    <select id="solid-provider">
                        <option value="">-- Kies provider --</option>
                    </select>
                    <button onclick="loginToSolid()">Inloggen met Solid</button>
                </div>
            </div>

            <!-- Logged in -->
            <div id="solid-profile" style="display: none;">
                <p>Ingelogd als: <strong id="solid-webid" title=""></strong></p>
                <div class="form-row">
                    <button onclick="showWishlistEditor()" class="primary-btn">Beheer Mijn Wishlist</button>
                    <a href="occasion.html" class="button primary-btn" style="text-decoration: none;">Maak Gelegenheid</a>
                    <button onclick="logoutFromSolid()">Uitloggen</button>
                </div>
            </div>
        </section>

        <!-- Section 2: Manage Groups -->
        <section id="groups-section" class="card">
            <h2>Groups</h2>
            <div class="form-row">
                <input type="text" id="group-name" placeholder="Group name">
                <button onclick="addGroup()">Add Group</button>
            </div>
            <div id="groups-container"></div>
        </section>

        <!-- Section 3: Manage Occasions -->
        <section id="occasions-section" class="card">
            <h2>Occasions</h2>
            <div class="form-row">
                <input type="text" id="occasion-name" placeholder="Occasion name (e.g., Christmas 2025)">
                <input type="date" id="occasion-date">
                <button onclick="addOccasion()">Add Occasion</button>
            </div>
            <ul id="occasions-list"></ul>
        </section>

        <!-- Section 4: Shuffle & Assignments -->
        <section id="shuffle-section" class="card">
            <h2 id="shuffle-heading">Shuffle &amp; Assignments</h2>
            <p class="info-text">Shuffles all persons. Each person is assigned someone from a <strong>different</strong> group.</p>
            <div class="form-row">
                <label for="select-occasion">Occasion:</label>
                <select id="select-occasion" onchange="updateEditionsList()">
                    <option value="">-- Select Occasion --</option>
                </select>
            </div>
            <div class="form-row checkbox-row">
                <label>
                    <input type="checkbox" id="prevent-reciprocal" checked>
                    Prevent reciprocal gifts (if A → B, then B cannot → A)
                </label>
            </div>
            <div class="form-row">
                <button onclick="runShuffle()" class="primary-btn">Run Shuffle (Create New Edition)</button>
            </div>

            <!-- Hidden exclusions/inclusions feature (tap heading 5x to reveal) -->
            <details class="advanced-settings" id="advanced-rules" style="display: none;">
                <summary>Advanced: Rules</summary>

                <h4>Exclusions (Cannot give to)</h4>
                <p class="help-text">Pairs who should NOT be assigned to each other (e.g., couples, roommates).</p>
                <div class="form-row">
                    <select id="exclusion-person1">
                        <option value="">-- Person 1 --</option>
                    </select>
                    <span class="rule-arrow">↔</span>
                    <select id="exclusion-person2">
                        <option value="">-- Person 2 --</option>
                    </select>
                    <button onclick="addExclusion()">Add</button>
                </div>
                <ul id="exclusions-list"></ul>

                <h4>Inclusions (Must give to)</h4>
                <p class="help-text">Force a specific person to give to another (one-way).</p>
                <div class="form-row">
                    <select id="inclusion-giver">
                        <option value="">-- Giver --</option>
                    </select>
                    <span class="rule-arrow">→</span>
                    <select id="inclusion-recipient">
                        <option value="">-- Recipient --</option>
                    </select>
                    <button onclick="addInclusion()">Add</button>
                </div>
                <ul id="inclusions-list"></ul>
            </details>

            <div id="editions-container">
                <h3>Editions</h3>
                <select id="select-edition" onchange="showAssignments()">
                    <option value="">-- Select Edition --</option>
                </select>
            </div>

            <div id="assignments-container">
                <h3>Assignments</h3>
                <ul id="assignments-list"></ul>
            </div>
        </section>

        <!-- Section 5: Share Data -->
        <section id="share-section" class="card">
            <h2>Share Data</h2>
            <p>Export your data to share with others, or import data from someone else.</p>
            <div class="form-row">
                <button onclick="exportDataJSON()">Export Data (.json)</button>
                <button onclick="document.getElementById('import-file').click()">Import Data (.json)</button>
                <input type="file" id="import-file" accept=".json" onchange="importDataJSON(event)" style="display: none;">
            </div>
        </section>

        <!-- Section 6: Export RDF -->
        <section id="export-section" class="card">
            <h2>Export as RDF</h2>
            <div class="form-row">
                <button onclick="exportAsTurtle()">Export as Turtle (.ttl)</button>
                <button onclick="downloadTurtle()">Download .ttl File</button>
            </div>
            <textarea id="export-output" placeholder="Turtle output will appear here..."></textarea>
        </section>

        <!-- Section 6: Reset -->
        <section id="reset-section" class="card danger">
            <h2>Reset Data</h2>
            <p>This will permanently delete all data stored in this browser.</p>
            <button onclick="resetAllData()" class="danger-btn">Reset All Data</button>
        </section>
    </main>

    <footer>
        <p>Gift Name Shuffler &mdash; A simple static web app for organizing gift exchanges.</p>
    </footer>

    <!-- Wishlist Editor Modal -->
    <div id="wishlist-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Mijn Verlanglijstje</h3>
                <button class="modal-close" onclick="closeWishlistModal()">&times;</button>
            </div>

            <div id="wishlist-items">
                <!-- Items will be rendered here -->
            </div>

            <div class="wishlist-form">
                <h4>Nieuw item toevoegen</h4>
                <div class="form-row">
                    <input type="text" id="wish-name" placeholder="Naam van het item">
                </div>
                <div class="form-row">
                    <textarea id="wish-description" placeholder="Beschrijving (optioneel)" rows="2"></textarea>
                </div>
                <div class="form-row">
                    <input type="url" id="wish-url" placeholder="Link naar product (optioneel)">
                    <select id="wish-priority">
                        <option value="1">⭐</option>
                        <option value="2">⭐⭐</option>
                        <option value="3" selected>⭐⭐⭐</option>
                        <option value="4">⭐⭐⭐⭐</option>
                        <option value="5">⭐⭐⭐⭐⭐</option>
                    </select>
                </div>
                <button onclick="addWishlistItem()" class="primary-btn">Toevoegen aan Wishlist</button>
            </div>
        </div>
    </div>

    <!-- Wishlist Viewer Modal (for viewing others' wishlists) -->
    <div id="wishlist-viewer-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="wishlist-viewer-title">Wishlist</h3>
                <button class="modal-close" onclick="closeWishlistViewer()">&times;</button>
            </div>
            <div id="wishlist-viewer-content">
                <!-- Wishlist items will be rendered here -->
            </div>
        </div>
    </div>

    <script src="main.js"></script>
    <script src="export.js"></script>
    <script type="module" src="solid.js"></script>
</body>
</html>
